<!DOCTYPE html>
<html manifest1="chemViewer.manifest1">
<head>
	<meta charset="UTF-8">
	<title>Chem Viewer 3D Demo</title>

	<link rel="stylesheet" type="text/css" href="../../libs/kekule/themes/default/kekule.css" />

	<script src="../../libs/Three.js"></script>
	<script src="../../libs/raphael-min.2.0.1.js"></script>
	<script src="../../libs/kekule/kekule.js?modules=chemWidget,openbabel"></script>
	<script src="../../../src/kekule.js?modules=chemWidget,algorithm&min=false"></script>
	<script src="aframe.min.js"></script>
<script src="aframe-ar.js"></script>
<script src="client.js"></script>
<div style='position: fixed; top: 10px; width:inherit; text-align: center; z-index: 1; background-color: rgba(255, 255, 255, 0.6);'>
  <font size=4>
  <p align=left><a href="https://clustrmaps.com/site/16ven" title="Visit tracker" target="_blank"><img src="//www.clustrmaps.com/map_v2.png?d=WKH-KVfaTQVRp0prhtkOvyuUkN06NcEhV8jz6L6pKpk&cl=ffffff"  width="1%" height="1%" alt="" /></a> <b>Move markers around for AR experience. (You need to print or load in phones <a href="markers.docx" download>these markers</a>)</b></p>
  </font>
  <font size=4 color=red><p id="infop" align=left></p></font>
</div>
	<style>
		html, body
		{
			margin: 0;
			padding: 0;
			position: relative;
			overflow: hidden;
		}
		#chemViewer
		{
			border: none;
			margin: 0;
		}
		#headerà¹…
		{
			padding: 0.2em 1em;
			overflow: hidden;
			vertical-align: middle;
		}
		#header button, #header span
		{
			display: inline-block;
		}
		.rotate-item {
			font-size: 1px;
		}
	</style>
	<script>
		var chemViewer;
		function init()
		{
			chemViewer = Kekule.Widget.getWidgetById('chemViewer');
			// adjust size
			adjustSize();

			window.onresize = adjustSize;

			Kekule.Widget.getWidgetById('btnOpenBabel').addEventListener('execute', function(e){
				Kekule.IO.enableOpenBabelFormats();
			});
		}
		function adjustSize()
		{
			var dim = Kekule.HtmlElementUtils.getViewportDimension(document);
			var headerDim = Kekule.HtmlElementUtils.getElemClientDimension(document.getElementById('header'));
			chemViewer.setWidth(dim.width - 10 + 'px').setHeight(dim.height - 10 - headerDim.height + 'px');
		}

		Kekule.X.domReady(init);

  <font size=4 color=red><p id="infop" align=left></p></font>
</div>
	</script>
	<a-scene embedded artoolkit='sourceType: webcam;' id="thescene">
		<!-- handle hiro marker-->
		<a-marker preset='hiro' id="lysmarker">


	<script name="mol1" id="mol1" type="chemical/x-mdl-molfile">
Untitled Document-1
OpenBabel10121821543D

 32 34  0  0  0  0  0  0  0  0999 V2000
   -0.7178    0.8903    0.2877 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.3379    1.5493    0.8576 N   0  0  0  0  0  0  0  0  0  0  0  0
   -0.6518   -0.3908    0.7877 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.6251    1.4068   -0.5762 N   0  0  0  0  0  0  0  0  0  0  0  0
    0.7099    2.9352    0.6164 C   0  0  3  0  0  0  0  0  0  0  0  0
    0.9989    0.6356    1.6419 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.6575   -1.3374    0.3582 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.4104   -0.5441    1.6385 N   0  0  0  0  0  0  0  0  0  0  0  0
   -2.5312    0.5429   -0.9502 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.8808    3.2586    1.4021 O   0  0  0  0  0  0  0  0  0  0  0  0
   -0.3487    3.9510    1.0138 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.5739   -0.7660   -0.5142 N   0  0  0  0  0  0  0  0  0  0  0  0
   -1.7330   -2.5135    0.6986 O   0  0  0  0  0  0  0  0  0  0  0  0
   -3.5123    0.9180   -1.8082 N   0  0  0  0  0  0  0  0  0  0  0  0
    1.4727    4.0934    2.5196 C   0  0  3  0  0  0  0  0  0  0  0  0
   -0.0514    4.1720    2.4766 C   0  0  3  0  0  0  0  0  0  0  0  0
    2.1944    5.4369    2.3940 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.5824    5.3982    2.9394 O   0  0  0  0  0  0  0  0  0  0  0  0
    3.6081    5.2256    2.4491 O   0  0  0  0  0  0  0  0  0  0  0  0
    0.9717    3.0064   -0.4449 H   0  0  0  0  0  0  0  0  0  0  0  0
    1.9013    0.8789    2.1896 H   0  0  0  0  0  0  0  0  0  0  0  0
   -1.3838    3.6449    0.8411 H   0  0  0  0  0  0  0  0  0  0  0  0
   -0.1993    4.8875    0.4611 H   0  0  0  0  0  0  0  0  0  0  0  0
   -3.2682   -1.3984   -0.8741 H   0  0  0  0  0  0  0  0  0  0  0  0
   -3.5627    1.9245   -1.9301 H   0  0  0  0  0  0  0  0  0  0  0  0
   -4.4204    0.4894   -1.6864 H   0  0  0  0  0  0  0  0  0  0  0  0
    1.8098    3.5906    3.4333 H   0  0  0  0  0  0  0  0  0  0  0  0
   -0.4775    3.3583    3.0760 H   0  0  0  0  0  0  0  0  0  0  0  0
    1.9255    6.1180    3.2061 H   0  0  0  0  0  0  0  0  0  0  0  0
    1.9779    5.9186    1.4353 H   0  0  0  0  0  0  0  0  0  0  0  0
   -1.5538    5.3358    2.9049 H   0  0  0  0  0  0  0  0  0  0  0  0
    3.7906    4.4677    1.8618 H   0  0  0  0  0  0  0  0  0  0  0  0
  1  2  1  0  0  0  0
  1  3  2  0  0  0  0
  1  4  1  0  0  0  0
  2  5  1  0  0  0  0
  2  6  1  0  0  0  0
  3  7  1  0  0  0  0
  3  8  1  0  0  0  0
  4  9  2  0  0  0  0
  5 10  1  0  0  0  0
  5 11  1  0  0  0  0
  5 20  1  0  0  0  0
  6  8  2  0  0  0  0
  6 21  1  0  0  0  0
  7 12  1  0  0  0  0
  7 13  2  0  0  0  0
  9 12  1  0  0  0  0
  9 14  1  0  0  0  0
 10 15  1  0  0  0  0
 11 16  1  0  0  0  0
 11 22  1  0  0  0  0
 11 23  1  0  0  0  0
 12 24  1  0  0  0  0
 14 25  1  0  0  0  0
 14 26  1  0  0  0  0
 15 16  1  0  0  0  0
 15 17  1  0  0  0  0
 15 27  1  0  0  0  0
 16 18  1  0  0  0  0
 16 28  1  0  0  0  0
 17 19  1  0  0  0  0
 17 29  1  0  0  0  0
 17 30  1  0  0  0  0
 18 31  1  0  0  0  0
 19 32  1  0  0  0  0
M  END

</script>

</head>
<body>
	<!-- <div id="chemViewer" style="width:1000px;height:650px"
			 data-widget="Kekule.ChemWidget.Viewer3D" data-enable-toolbar="true" data-auto-size="false" data-padding="20"
			 data-toolbar-evoke-modes="[0]"
			 data-chem-obj="url(#mol1)"
			 ></div> -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script async type="text/javascript">
	$(window).on('load', function rotateFunction() {
		var node = document.querySelector('[title="Rotate around Z axis"]');
		for (var i = 50-1; i >= 0; i--) {
			console.log(node);
			node.click();
			console.log( "true" );
		}		
	});

</script>
<a-entity camera></a-entity>
	</a-scene>
</body>

<script type="text/javascript">
	var lysopaq = new Array(17)
    var gluopaq = new Array(10)
    
    setInterval(function(){
		document.getElementById("thescene").object3D.updateMatrixWorld();
        var p1 = new THREE.Vector3(); p1.setFromMatrixPosition(document.getElementById("lys6").object3D.matrixWorld);
        var p2 = new THREE.Vector3(); p2.setFromMatrixPosition(document.getElementById("glu5").object3D.matrixWorld);
        var p3 = new THREE.Vector3(); p3.setFromMatrixPosition(document.getElementById("glu6").object3D.matrixWorld);
		distNO1 = 2 * Math.sqrt( Math.pow(p2.x-p1.x,2) + Math.pow(p2.y-p1.y,2) + Math.pow(p2.z-p1.z,2) )        
		distNO2 = 2 * Math.sqrt( Math.pow(p3.x-p1.x,2) + Math.pow(p3.y-p1.y,2) + Math.pow(p3.z-p1.z,2) )        
		document.getElementById("infop").innerHTML="<p align='left'>N-O1 distance: " + distNO1 + " &#8491<br>N-O2 distance: " + distNO2 + " &#8491<br>Electrostatics: " + (-1/distNO1/distNO1 - 1/distNO2/distNO2) + "</p>";        
        
        for (i=0;i<17;i++) {lysopaq[i]=0}
        for (i=0;i<10;i++) {gluopaq[i]=0}
          
        for (i=1;i<18;i++) {
          var p1 = new THREE.Vector3(); p1.setFromMatrixPosition(document.getElementById("lys"+i).object3D.matrixWorld);
          for (j=1;j<11;j++) {
            var p2 = new THREE.Vector3(); p2.setFromMatrixPosition(document.getElementById("glu"+j).object3D.matrixWorld);
            distancia = 2 * Math.sqrt( Math.pow(p2.x-p1.x,2) + Math.pow(p2.y-p1.y,2) + Math.pow(p2.z-p1.z,2) );
            if (distancia < 3) {
              lysopaq[i-1]=0.5
              gluopaq[j-1]=0.5
            }
          }
        }

		for (i=18;i<35;i++) { document.getElementById("lys"+i).setAttribute('opacity',lysopaq[i-18])}
        for (i=11;i<21;i++) { document.getElementById("glu"+i).setAttribute('opacity',gluopaq[i-11])}

    }, 200);
</script>
</html>